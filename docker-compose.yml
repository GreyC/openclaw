services:
  openclaw-gateway:
    build: .
    image: openclaw:local
    user: root
    environment:
      HOME: /root
      OPENCLAW_GATEWAY_TOKEN: 3b362a65b1ad090ebcf516bd337c2db953f05609a7e7b620
    volumes:
      - /root/.openclaw:/root/.openclaw
    cap_add:
      - NET_ADMIN
    init: true
    restart: unless-stopped
    entrypoint: ["/bin/sh", "-c"]
    command:
      - |
        mkdir -p /root/.openclaw/tailscale
        tailscaled --tun=userspace-networking --statedir=/root/.openclaw/tailscale &
        sleep 5
        tailscale up --hostname=openclaw-bot
        tailscale serve --bg --yes http://0.0.0.0:18789
        exec node dist/index.js gateway --bind lan --port 18789
